<ion-header>

    <ion-navbar>
        <button ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <ion-title>Mensagens</ion-title>
    </ion-navbar>

</ion-header>

<ion-content>
    <ion-refresher (ionRefresh)="doRefresh($event)">
        <ion-refresher-content refreshingText="Atualizando..." pullingIcon="arrow-dropdown" pullingText="Puxe para atualizar"
            refreshingSpinner="bubbles">
        </ion-refresher-content>
    </ion-refresher>
    <div text-center>
        <ion-spinner *ngIf="!carregou" name="bubbles"></ion-spinner>
    </div>
    <div *ngIf="carregou">

        <ion-list>
            <ion-item *ngFor="let mensagem of mensagens" (click)="goToDetalhes(mensagem)" class="item divisoria">

                <ion-icon class="icon-not-read" item-end *ngIf="!mensagem.mensagemLida" color="danger" name="ios-cog-outline">
                    <ion-badge>{{numberNotMessageByPaciente}}</ion-badge>
                </ion-icon>

                <ion-avatar item-left>
                    <img 
                    [src]="mensagem.caminhoImagemLinhaCuidado ? mensagem.caminhoImagemLinhaCuidado : mensagem.geral ? 'assets/imgs/todas.png' :'assets/imgs/individual.png'">
                </ion-avatar>
                <h2 class="assunto">{{mensagem.assunto}}</h2>
                <p>Tipo mensagem: {{exibirTipoMensagem(mensagem)}}</p>
                <p>De {{mensagem.nomeProfissionalSaude | extractWords:2}} as {{mensagem.dataEnvio}}</p>
                <ion-grid>
                    <ion-row>
                        <ion-col col-12>
                        </ion-col>
                    </ion-row>
                </ion-grid>
            </ion-item>
            <ion-infinite-scroll (ionInfinite)="doInfinite($event)">
                    <ion-infinite-scroll-content></ion-infinite-scroll-content>
                  </ion-infinite-scroll>
        </ion-list>
        <p [hidden]="mensagens?.length > 0 || carregando" class="msg-erro">Nenhuma mensagem encontrada</p>
    </div>
</ion-content>